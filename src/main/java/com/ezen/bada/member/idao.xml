<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.ezen.bada.member.Service">

<select id="login_check" resultType="String">
   SELECT role FROM bada_user WHERE id =#{param1} and pw = #{param2}
</select>

<select id="idcheck" resultType="String">
	select id from bada_user where id=#{param1}
</select>

<select id="emailcheck" resultType="String">
	select email from bada_user where email=#{param1}
</select>

<insert id="membersave">
   insert into bada_user(user_number,id,pw,name,email,gender,age)
   values (user_seq.nextval, #{param1}, #{param2}, #{param3},
   #{param4}, #{param5}, #{param6})
</insert>

<select id="memberout" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user
</select>
<!-- 기본 memberout이지만 일단은 *로 뽑았습니다! jsp 파일에서 출력 시에 출력만 선별해서 하면 되니까요!
근데 혹시 보안상의 문제가 있을 것 같다면 select user_number, id, name, gender, age from bada_user로 수정해주셔도 좋아용~
from. (정)지수 -->

<!-- 서치의 늪 시작 -->
<select id="member_search_num_n_n" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where user_number like '%' || #{param1} || '%'
</select>

<select id="member_search_num_n_a" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where user_number like '%' || #{param1} || '%' 
   and age = #{param2}
</select>

<select id="member_search_num_g_n" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where user_number like '%' || #{param1} || '%' 
   and gender = #{param2}
</select>

<select id="member_search_num_g_a" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where user_number like '%' || #{param1} || '%'
   and gender = #{param2} and age = #{param3}
</select>
<!-- 회원번호로 서치 끝 -->

<select id="member_search_id_n_n" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where id like '%' || #{param1} || '%'
</select>

<select id="member_search_id_n_a" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where id like '%' || #{param1} || '%' 
   and age = #{param2}
</select>

<select id="member_search_id_g_n" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where id like '%' || #{param1} || '%' 
   and gender = #{param2}
</select>

<select id="member_search_id_g_a" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where id like '%' || #{param1} || '%'
   and gender = #{param2} and age = #{param3}
</select>
<!-- 아이디로 서치 끝 -->

<select id="member_search_name_n_n" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where name like '%' || #{param1} || '%'
</select>

<select id="member_search_name_n_a" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where name like '%' || #{param1} || '%' 
   and age = #{param2}
</select>

<select id="member_search_name_g_n" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where name like '%' || #{param1} || '%' 
   and gender = #{param2}
</select>

<select id="member_search_name_g_a" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where name like '%' || #{param1} || '%'
   and gender = #{param2} and age = #{param3}
</select>
<!-- 이름으로 서치 끝 -->

<!-- 회원정보 찾기 -->

<select id="lookid" resultType="com.ezen.bada.member.MemberDTO">
    SELECT name, id FROM bada_user where name = #{param1} AND email= #{param2}
</select>

<select id="lookpw" resultType="com.ezen.bada.member.MemberDTO">
    SELECT name, id, pw FROM bada_user where id = #{param1} AND email= #{param2}
</select>


<!-- 회원 번호로 정보 전체 가져오기 -->
<select id="member_detail_out" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where user_number = #{param1}
</select>

<select id="admincheck" resultType="java.lang.String">
	select id from bada_user where role='admin' and pw=#{param1}
</select>

<!-- 회원 정보 수정하기 -->
<update id="member_modify">
	update bada_user set pw = #{param1}, name = #{param2}, email = #{param3}, gender = #{param4}, age = #{param5} where id = #{param6}
</update>


<!-- 마이페이지 -->

<select id="myinfo_main" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where id = #{param1}
</select>

<select id="myinfo_modify" resultType="com.ezen.bada.member.MemberDTO">
   select * from bada_user where id = #{param1}
</select>
<!-- 이메일 중복확인 -->

<update id="info_update1">
	update bada_user set pw=#{param1}, email=#{param2}, gender=#{param3},
	age=#{param4} where id=#{param5}
</update>

<update id="info_update2">
	update bada_user set email=#{param1}, gender=#{param2},
	age=#{param3} where id=#{param4}
</update>

<!-- 회원정보 수정 -->
<update id="update_info">
   update bada_user set pw = #{param2}, email = #{param3}, gender = #{param4}, age = #{param5} where id = #{param1}
</update>

<update id="update_no_pw">
   update bada_user set email = #{param2}, gender = #{param3}, age = #{param4} where id = #{param1}
</update>

<!-- 비밀번호 검증 -->

<select id="verify_Password" resultType="String">
   select pw from bada_user where id = #{param1}
</select>

<select id="quit_Password" resultType="String">
   select pw from bada_user where id = #{param1}
</select>

<!-- 회원탈퇴 -->

<delete id="quit_member">
	delete from bada_user where id = #{param1}
</delete>

</mapper>